{"version":3,"sources":["../../src/lib/utils.ts"],"sourcesContent":["import type {\n  InferTranslationKeys,\n  InferTranslationLocales,\n  TranslationConfig,\n  TranslationFn,\n  TranslationKey,\n} from '../types.js'\n\n/**\n * Replaces placeholders (e.g., ${count}) in translation strings.\n */\nconst replaceParams = (template: string, params: Record<string, any> = {}) =>\n  Object.entries(params).reduce(\n    (result, [key, value]) => result.replace(`\\${${key}}`, String(value)),\n    template,\n  )\n\n/**\n * Creates a translation function (`t`) from a dictionary.\n * This function can be used both on the server and in a client provider.\n */\nexport function createTranslation<T>(\n  locale: string,\n  config: T,\n): TranslationFn<InferTranslationLocales<T>, InferTranslationKeys<T>> {\n  type L = InferTranslationLocales<T>\n  type K = InferTranslationKeys<T>\n\n  return (key: K, params?: Record<string, any>): string => {\n    const entry = (config as any).translations[key]\n    if (!entry) {\n      return String(key)\n    }\n\n    const raw = entry[locale] ?? entry[(config as any).defaultLocale] ?? entry.key\n\n    return params ? replaceParams(raw) : raw\n  }\n}\n\n// export const createTranslationDepricated = <L extends string, K extends string>(\n//   locale: string,\n//   config: TranslationConfig<L, K>,\n// ) => {\n//   return (key: TranslationKey<L, K>, params?: Record<string, any>) =>\n//     getTranslation({ config, key, locale, params })\n// }\n\n/**\n * Retrieves a translation with optional parameter replacement.\n */\nconst getTranslation = <L extends string, K extends string>({\n  config,\n  key,\n  locale,\n  params,\n}: {\n  config: TranslationConfig<L, K>\n  key: TranslationKey<L, K>\n  locale: string\n  params?: Record<string, any>\n}): string => {\n  const entry = config.translations[key] as\n    | {\n        [locale: string]: null | string | undefined\n        key: string\n      }\n    | undefined\n\n  if (!entry) {\n    return key\n  }\n  const template = entry[locale]\n\n  return template ? replaceParams(template, params) : key\n}\n\nexport function entriesOf<T extends Record<string, any>>(obj: T) {\n  return Object.entries(obj) as [keyof T, T[keyof T]][]\n}\n"],"names":["replaceParams","template","params","Object","entries","reduce","result","key","value","replace","String","createTranslation","locale","config","entry","translations","raw","defaultLocale","getTranslation","entriesOf","obj"],"mappings":"AAQA;;CAEC,GACD,MAAMA,gBAAgB,CAACC,UAAkBC,SAA8B,CAAC,CAAC,GACvEC,OAAOC,OAAO,CAACF,QAAQG,MAAM,CAC3B,CAACC,QAAQ,CAACC,KAAKC,MAAM,GAAKF,OAAOG,OAAO,CAAC,CAAC,GAAG,EAAEF,IAAI,CAAC,CAAC,EAAEG,OAAOF,SAC9DP;AAGJ;;;CAGC,GACD,OAAO,SAASU,kBACdC,MAAc,EACdC,MAAS;IAKT,OAAO,CAACN,KAAQL;QACd,MAAMY,QAAQ,AAACD,OAAeE,YAAY,CAACR,IAAI;QAC/C,IAAI,CAACO,OAAO;YACV,OAAOJ,OAAOH;QAChB;QAEA,MAAMS,MAAMF,KAAK,CAACF,OAAO,IAAIE,KAAK,CAAC,AAACD,OAAeI,aAAa,CAAC,IAAIH,MAAMP,GAAG;QAE9E,OAAOL,SAASF,cAAcgB,OAAOA;IACvC;AACF;AAEA,mFAAmF;AACnF,oBAAoB;AACpB,qCAAqC;AACrC,SAAS;AACT,wEAAwE;AACxE,sDAAsD;AACtD,IAAI;AAEJ;;CAEC,GACD,MAAME,iBAAiB,CAAqC,EAC1DL,MAAM,EACNN,GAAG,EACHK,MAAM,EACNV,MAAM,EAMP;IACC,MAAMY,QAAQD,OAAOE,YAAY,CAACR,IAAI;IAOtC,IAAI,CAACO,OAAO;QACV,OAAOP;IACT;IACA,MAAMN,WAAWa,KAAK,CAACF,OAAO;IAE9B,OAAOX,WAAWD,cAAcC,UAAUC,UAAUK;AACtD;AAEA,OAAO,SAASY,UAAyCC,GAAM;IAC7D,OAAOjB,OAAOC,OAAO,CAACgB;AACxB"}